# Raft-cpp

基于C++实现的分布式共识算法Raft，并在其上构建了分布式键值存储系统。

## 项目介绍

该项目是一个基于Raft共识算法的分布式键值存储系统实现，使用C++语言开发。项目包含以下主要组件：

- **Raft核心算法**：实现了完整的Raft共识算法，包括领导者选举、日志复制、安全性保证等核心机制
- **分布式键值存储**：基于Raft算法构建的高可用KV存储系统
- **跳表索引**：使用跳表数据结构进行高效的数据索引和查询
- **RPC通信框架**：基于Protobuf的RPC实现，用于节点间通信
- **持久化**：支持状态持久化和快照机制，确保系统可靠性

## 系统特性

- **强一致性**：基于Raft算法保证数据的强一致性
- **高可用性**：支持节点故障恢复，保证系统的高可用
- **快照机制**：通过快照减少日志体积，加速节点恢复
- **线性扩展**：可以方便地扩展集群节点数量
- **高性能存储**：采用跳表结构提供高效的数据存取

## 快速开始

### 编译构建

```bash
# 克隆项目
git clone https://github.com/yourusername/Raft-cpp.git
cd Raft-cpp

# 运行构建脚本
./autobuild.sh
```

### 运行示例

启动Raft集群（例如，启动3个节点的集群）：

```bash
cd bin
./raftCoreRun -n 3
```

使用客户端测试键值存储功能：

```bash
cd bin
./callerMain
```

## 项目结构

- **src/raftCore/**：Raft共识算法核心实现
- **src/skipList/**：跳表数据结构实现
- **src/rpcService/**：RPC服务相关代码和协议定义
- **src/rpcSrc/**：RPC核心实现
- **src/raftClerk/**：客户端与服务器交互的接口
- **src/common/**：通用工具和配置
- **example/**：使用示例和测试代码
- **bin/**：编译生成的可执行文件
- **lib/**：编译生成的库文件

## 核心功能实现

### Raft算法

本项目实现了完整的Raft共识算法：

- **领导者选举**：通过超时机制和投票实现领导者选举
- **日志复制**：领导者负责复制日志到所有节点
- **安全性保证**：确保已提交的日志在集群中安全保留
- **成员变更**：支持动态调整集群规模

### 键值存储系统

在Raft之上实现的分布式键值存储系统：

- **Put/Append操作**：添加或追加键值对
- **Get操作**：获取键对应的值
- **原子操作保证**：通过Raft确保操作的原子性和一致性

### 优化

- **快照机制**：定期对状态机做快照，减少日志体积
- **日志压缩**：防止日志无限增长
- **批量提交**：提高系统吞吐量
